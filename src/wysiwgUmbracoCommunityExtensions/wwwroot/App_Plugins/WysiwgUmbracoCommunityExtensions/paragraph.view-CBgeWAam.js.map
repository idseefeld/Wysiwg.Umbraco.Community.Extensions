{"version":3,"file":"paragraph.view-CBgeWAam.js","sources":["../../../Wysiwg/src/blocks/views/paragraph.view.ts"],"sourcesContent":["import { UmbTextStyles } from \"@umbraco-cms/backoffice/style\";\r\nimport {\r\n  html,\r\n  customElement,\r\n  LitElement,\r\n  property,\r\n  css,\r\n  unsafeHTML,\r\n  state,\r\n} from \"@umbraco-cms/backoffice/external/lit\";\r\nimport { UmbElementMixin } from \"@umbraco-cms/backoffice/element-api\";\r\nimport type {\r\n  UmbBlockDataModel,\r\n  UmbBlockDataType,\r\n} from \"@umbraco-cms/backoffice/block\";\r\nimport type { UmbBlockEditorCustomViewConfiguration, UmbBlockEditorCustomViewElement } from \"@umbraco-cms/backoffice/block-custom-view\";\r\nimport {\r\n  UMB_PROPERTY_DATASET_CONTEXT,\r\n  UmbPropertyDatasetContext,\r\n  UmbPropertyValueDataPotentiallyWithEditorAlias,\r\n} from \"@umbraco-cms/backoffice/property\";\r\nimport { UmbBlockGridValueModel } from \"@umbraco-cms/backoffice/block-grid\";\r\n\r\nconst customElementName = \"wysiwg-block-paragraph-view\";\r\n@customElement(customElementName)\r\nexport class WysiwgBlockParagraphView\r\n  extends UmbElementMixin(LitElement)\r\n  implements UmbBlockEditorCustomViewElement {\r\n  //\r\n  @property({ attribute: false })\r\n  content?: UmbBlockDataType;\r\n\r\n  @property({ attribute: false })\r\n  config?: UmbBlockEditorCustomViewConfiguration;\r\n\r\n  @property({ attribute: false })\r\n  settings?: UmbBlockDataType;\r\n\r\n  @state()\r\n  datasetSettings?: UmbBlockDataModel[];\r\n\r\n  #datasetContext?: UmbPropertyDatasetContext;\r\n\r\n  constructor() {\r\n    super();\r\n    this.consumeContext(UMB_PROPERTY_DATASET_CONTEXT, async (context) =>\r\n      this.getSettings(context)\r\n    );\r\n  }\r\n\r\n  async getSettings(context: any) {\r\n    this.#datasetContext = context;\r\n    this.observe(\r\n      this.#datasetContext?.properties,\r\n      async (properties) => {\r\n        const pageProperties = properties as Array<UmbPropertyValueDataPotentiallyWithEditorAlias>;\r\n        if (pageProperties?.length) {\r\n          const allGridValues = pageProperties\r\n            .filter((v) => v.editorAlias === \"Umbraco.BlockGrid\") as Array<UmbPropertyValueDataPotentiallyWithEditorAlias>;\r\n\r\n          const editSettingsPath = this.config?.editSettingsPath ?? \"\";\r\n          console.debug(\"editSettingsPath: \", editSettingsPath);\r\n\r\n          let thisGrid = allGridValues[0];\r\n          if (allGridValues.length > 1) {\r\n            for (let i = 0; i < allGridValues.length; i++) {\r\n              const grid = allGridValues[i];\r\n              if (grid.alias && (editSettingsPath.indexOf(grid.alias) >= 0)) {\r\n                thisGrid = grid;\r\n                break;\r\n              }\r\n            }\r\n          }\r\n          const gridValues = thisGrid.value as UmbBlockGridValueModel;\r\n          console.debug(\"thisGrid.alias: \", thisGrid.alias);\r\n\r\n          if (gridValues.settingsData?.length) {\r\n            // paragraph specific\r\n            // const valueValue = pageProperties.find((v) => v.editorAlias === \"Umbraco.BlockGrid\")// && v.alias === \"main\")\r\n            //   ?.value as UmbBlockGridValueModel;\r\n            // this.datasetSettings = valueValue.settingsData;\r\n\r\n            this.datasetSettings = gridValues.settingsData;\r\n          }\r\n        }\r\n      },\r\n      \"_observeProperties\"\r\n    );\r\n  }\r\n\r\n  override render() {\r\n    let color = { label: \"\", value: \"\" };\r\n    let inlineStyle = \"\";\r\n    if (this.datasetSettings?.length) {\r\n      const layout = (this as UmbBlockEditorCustomViewElement).layout;\r\n      const settings = this.datasetSettings.filter(\r\n        (s) => layout?.settingsKey === s.key\r\n      )[0]?.values;\r\n\r\n      const colorSetting =\r\n        (settings.filter((v) => v.alias === \"color\")[0]?.value as {\r\n          label: string;\r\n          value: string;\r\n        }) ?? color;\r\n      if (colorSetting?.value) {\r\n        inlineStyle = `color: ${colorSetting?.value};`;\r\n      }\r\n    }\r\n\r\n    if (inlineStyle) {\r\n      inlineStyle = `style=\"${inlineStyle}\"`;\r\n    }\r\n    var property = this.content?.text as { blocks: {}; markup: string };\r\n    var markup = property?.markup;\r\n    const innerHtml = `<div class=\"paragraph\" ${inlineStyle}>${markup}</div>`;\r\n    return html`${unsafeHTML(innerHtml)}`;\r\n  }\r\n\r\n  static override styles = [\r\n    UmbTextStyles,\r\n    css`\r\n      :host {\r\n        display: block;\r\n        height: 100%;\r\n        box-sizing: border-box;\r\n        margin: 0;\r\n        padding: 0;\r\n        font-family: var(--wysiwg-font-family, initial);\r\n      }\r\n\r\n      h2 {\r\n        font-size: var(--wysiwg-font-size-24, 24px);\r\n        line-height: var(--wysiwg-line-height-28, 28px);\r\n        margin: var(--wysiwg-headline-paragraph-2-margin, 0);\r\n      }\r\n\r\n      h3 {\r\n        font-size: var(--wysiwg-font-size-16, 16px);\r\n        line-height: var(--wysiwg-line-height-24, 24px);\r\n        margin: var(--wysiwg-headline-paragraph-3-margin, 0);\r\n      }\r\n\r\n      p\r\n      {\r\n        font-size: var(--wysiwg-font-size-16, 16px);\r\n        line-height: var(--wysiwg-line-height-24, 24px);\r\n        margin: var(--wysiwg-p-paragraph-margin, 0);\r\n        padding: var(--wysiwg-p-paragraph-padding, 0);\r\n      }\r\n    `,\r\n  ];\r\n}\r\n\r\nexport default WysiwgBlockParagraphView;\r\n\r\ndeclare global {\r\n  interface HTMLElementTagNameMap {\r\n    [customElementName]: WysiwgBlockParagraphView;\r\n  }\r\n}\r\n"],"names":["_datasetContext","customElementName","WysiwgBlockParagraphView","UmbElementMixin","LitElement","__privateAdd","UMB_PROPERTY_DATASET_CONTEXT","context","__privateSet","_a","__privateGet","properties","pageProperties","allGridValues","v","editSettingsPath","thisGrid","i","grid","gridValues","_b","color","inlineStyle","layout","colorSetting","_c","s","property","_d","markup","innerHtml","html","unsafeHTML","UmbTextStyles","css","__decorateClass","state","customElement","WysiwgBlockParagraphView$1"],"mappings":"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"}