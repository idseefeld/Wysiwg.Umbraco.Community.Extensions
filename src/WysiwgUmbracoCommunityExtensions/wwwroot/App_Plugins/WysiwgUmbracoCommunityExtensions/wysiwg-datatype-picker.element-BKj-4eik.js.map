{"version":3,"file":"wysiwg-datatype-picker.element-BKj-4eik.js","sources":["../../../Wysiwg/src/property-editors/data-type-picker/wysiwg-datatype-picker.element.ts"],"sourcesContent":["import { UmbTextStyles } from \"@umbraco-cms/backoffice/style\";\r\nimport { html, customElement, state, property, nothing } from \"@umbraco-cms/backoffice/external/lit\";\r\nimport { UmbLitElement } from \"@umbraco-cms/backoffice/lit-element\";\r\nimport { UMB_PROPERTY_EDITOR_UI_PICKER_MODAL, UmbPropertyEditorUiElement } from \"@umbraco-cms/backoffice/property-editor\";\r\nimport { UMB_DATA_TYPE_WORKSPACE_CONTEXT } from \"@umbraco-cms/backoffice/data-type\";\r\nimport { umbBindToValidation } from \"@umbraco-cms/backoffice/validation\";\r\nimport { UMB_MODAL_MANAGER_CONTEXT } from \"@umbraco-cms/backoffice/modal\";\r\n\r\nconst elementName =\"wysiwg-datatype-picker\";\r\n@customElement(elementName)\r\nexport class WysiwgDatatypePickerPropertyEditor extends UmbLitElement implements UmbPropertyEditorUiElement {\r\n  @property()\r\n  public value?: string;\r\n\r\n  @state()\r\n  dataTypes: string[] = [];\r\n\r\n\t@state()\r\n\tprivate _propertyEditorUiIcon?: string | null = null;\r\n\r\n\t@state()\r\n\tprivate _propertyEditorUiName?: string | null = null;\r\n\r\n\t@state()\r\n\tprivate _propertyEditorUiAlias?: string | null = null;\r\n\r\n\t@state()\r\n\tprivate _propertyEditorSchemaAlias?: string | null = null;\r\n  #workspaceContext?: typeof UMB_DATA_TYPE_WORKSPACE_CONTEXT.TYPE;\r\n\r\n  #observeDataType() {\r\n\t\tif (!this.#workspaceContext) {\r\n\t\t\treturn;\r\n\t\t}\r\n\r\n\t\tthis.observe(this.#workspaceContext.propertyEditorUiAlias, (value) => {\r\n\t\t\tthis._propertyEditorUiAlias = value;\r\n\t\t});\r\n\r\n\t\tthis.observe(this.#workspaceContext.propertyEditorSchemaAlias, (value) => {\r\n\t\t\tthis._propertyEditorSchemaAlias = value;\r\n\t\t});\r\n\r\n\t\tthis.observe(this.#workspaceContext.propertyEditorUiName, (value) => {\r\n\t\t\tthis._propertyEditorUiName = value;\r\n\t\t});\r\n\r\n\t\tthis.observe(this.#workspaceContext.propertyEditorUiIcon, (value) => {\r\n\t\t\tthis._propertyEditorUiIcon = value;\r\n\t\t});\r\n\t}\r\n\r\n  constructor() {\r\n\t\tsuper();\r\n\r\n\t\tthis.consumeContext(UMB_DATA_TYPE_WORKSPACE_CONTEXT, (workspaceContext) => {\r\n\t\t\tthis.#workspaceContext = workspaceContext;\r\n\t\t\tthis.#observeDataType();\r\n\t\t});\r\n\t}\r\n\r\n  async #openPropertyEditorUIPicker() {\r\n\t\tconst modalManager = await this.getContext(UMB_MODAL_MANAGER_CONTEXT);\r\n\t\tconst value = await modalManager\r\n\t\t\t.open(this, UMB_PROPERTY_EDITOR_UI_PICKER_MODAL, {\r\n\t\t\t\tvalue: {\r\n\t\t\t\t\tselection: this._propertyEditorUiAlias ? [this._propertyEditorUiAlias] : [],\r\n\t\t\t\t},\r\n\t\t\t})\r\n\t\t\t.onSubmit()\r\n\t\t\t.catch(() => undefined);\r\n\r\n\t\tif (value) {\r\n\t\t\tthis.#workspaceContext?.setPropertyEditorUiAlias(value.selection[0]);\r\n\t\t}\r\n\t}\r\n\r\n\t#renderChooseButton() {\r\n\t\treturn html`\r\n\t\t\t<umb-property-layout\r\n\t\t\t\tdata-mark=\"property:editorUiAlias\"\r\n\t\t\t\tlabel=\"Property Editor\"\r\n\t\t\t\tdescription=${this.localize.term('propertyEditorPicker_title')}>\r\n\t\t\t\t<uui-button\r\n\t\t\t\t\tslot=\"editor\"\r\n\t\t\t\t\tid=\"btn-add\"\r\n\t\t\t\t\tlabel=${this.localize.term('propertyEditorPicker_title')}\r\n\t\t\t\t\tlook=\"placeholder\"\r\n\t\t\t\t\tcolor=\"default\"\r\n\t\t\t\t\trequired\r\n\t\t\t\t\t${umbBindToValidation(this)}\r\n\t\t\t\t\t@click=${this.#openPropertyEditorUIPicker}></uui-button>\r\n\t\t\t</umb-property-layout>\r\n\t\t`;\r\n\t}\r\n\r\n  #renderPropertyEditorReference() {\r\n\t\tif (!this._propertyEditorUiAlias || !this._propertyEditorSchemaAlias) return nothing;\r\n\t\treturn html`\r\n\t\t\t<umb-property-layout\r\n\t\t\t\tdata-mark=\"property:editorUiAlias\"\r\n\t\t\t\tlabel=\"Property Editor\"\r\n\t\t\t\tdescription=${this.localize.term('propertyEditorPicker_title')}>\r\n\t\t\t\t<umb-ref-property-editor-ui\r\n\t\t\t\t\tslot=\"editor\"\r\n\t\t\t\t\tname=${this._propertyEditorUiName ?? ''}\r\n\t\t\t\t\talias=${this._propertyEditorUiAlias}\r\n\t\t\t\t\tproperty-editor-schema-alias=${this._propertyEditorSchemaAlias}\r\n\t\t\t\t\tstandalone\r\n\t\t\t\t\t@open=${this.#openPropertyEditorUIPicker}>\r\n\t\t\t\t\t${this._propertyEditorUiIcon\r\n\t\t\t\t\t\t? html`<umb-icon name=${this._propertyEditorUiIcon} slot=\"icon\"></umb-icon>`\r\n\t\t\t\t\t\t: nothing}\r\n\t\t\t\t\t<uui-action-bar slot=\"actions\">\r\n\t\t\t\t\t\t<uui-button\r\n\t\t\t\t\t\t\tlabel=${this.localize.term('general_change')}\r\n\t\t\t\t\t\t\t@click=${this.#openPropertyEditorUIPicker}></uui-button>\r\n\t\t\t\t\t</uui-action-bar>\r\n\t\t\t\t</umb-ref-property-editor-ui>\r\n\t\t\t</umb-property-layout>\r\n\t\t`;\r\n\t}\r\n\r\n\toverride render() {\r\n\t\treturn html`\r\n\t\t\t<uui-box>\r\n\t\t\t\t${this._propertyEditorUiAlias && this._propertyEditorSchemaAlias\r\n\t\t\t\t\t? this.#renderPropertyEditorReference()\r\n\t\t\t\t\t: this.#renderChooseButton()}\r\n\t\t\t</uui-box>\r\n\t\t`;\r\n\t}\r\n  static override styles = [UmbTextStyles];\r\n}\r\n\r\nexport default WysiwgDatatypePickerPropertyEditor;\r\n\r\ndeclare global {\r\n  interface HTMLElementTagNameMap {\r\n    [elementName]: WysiwgDatatypePickerPropertyEditor;\r\n  }\r\n}\r\n"],"names":["_workspaceContext","_WysiwgDatatypePickerPropertyEditor_instances","observeDataType_fn","openPropertyEditorUIPicker_fn","renderChooseButton_fn","renderPropertyEditorReference_fn","elementName","WysiwgDatatypePickerPropertyEditor","UmbLitElement","__privateAdd","UMB_DATA_TYPE_WORKSPACE_CONTEXT","workspaceContext","__privateSet","__privateMethod","html","__privateGet","value","UMB_MODAL_MANAGER_CONTEXT","UMB_PROPERTY_EDITOR_UI_PICKER_MODAL","_a","umbBindToValidation","nothing","UmbTextStyles","__decorateClass","property","state","customElement","WysiwgDatatypePickerPropertyEditor$1"],"mappings":";;;;;;;;;;;;;wXAAAA,GAAAC,GAAAC,GAAAC,GAAAC,GAAAC;AAQA,MAAMC,IAAa;AAEN,IAAAC,IAAN,cAAiDC,EAAoD;AAAA,EA0C1G,cAAc;AACR,UAAA,GA3CDC,EAAA,MAAAR,CAAA,GAKL,KAAA,YAAsB,CAAC,GAGxB,KAAQ,wBAAwC,MAGhD,KAAQ,wBAAwC,MAGhD,KAAQ,yBAAyC,MAGjD,KAAQ,6BAA6C,MACpDQ,EAAA,MAAAT,CAAA,GA2BK,KAAA,eAAeU,GAAiC,CAACC,MAAqB;AAC1E,MAAAC,EAAA,MAAKZ,GAAoBW,CAAA,GACzBE,EAAA,MAAKZ,GAALC,CAAA,EAAA,KAAA,IAAA;AAAA,IAAA,CACA;AAAA,EAAA;AAAA,EAiEO,SAAS;AACV,WAAAY;AAAA;AAAA,MAEH,KAAK,0BAA0B,KAAK,6BACnCD,QAAKZ,GAALI,CAAA,EAAA,KAAA,IAAA,IACAQ,EAAK,MAAAZ,GAAAG,CAAA,EAAL,KAA0B,IAAA,CAAA;AAAA;AAAA;AAAA,EAAA;AAKjC;AAzGEJ,IAAA,oBAAA,QAAA;AAlBKC,IAAA,oBAAA,QAAA;AAoBLC,IAAgB,WAAG;AACf,EAACa,QAAKf,CAAmB,MAI7B,KAAK,QAAQe,EAAA,MAAKf,CAAkB,EAAA,uBAAuB,CAACgB,MAAU;AACrE,SAAK,yBAAyBA;AAAA,EAAA,CAC9B,GAED,KAAK,QAAQD,EAAA,MAAKf,CAAkB,EAAA,2BAA2B,CAACgB,MAAU;AACzE,SAAK,6BAA6BA;AAAA,EAAA,CAClC,GAED,KAAK,QAAQD,EAAA,MAAKf,CAAkB,EAAA,sBAAsB,CAACgB,MAAU;AACpE,SAAK,wBAAwBA;AAAA,EAAA,CAC7B,GAED,KAAK,QAAQD,EAAA,MAAKf,CAAkB,EAAA,sBAAsB,CAACgB,MAAU;AACpE,SAAK,wBAAwBA;AAAA,EAAA,CAC7B;AACF;AAWOb,IAA2B,iBAAG;;AAEpC,QAAMa,IAAQ,OADO,MAAM,KAAK,WAAWC,CAAyB,GAElE,KAAK,MAAMC,GAAqC;AAAA,IAChD,OAAO;AAAA,MACN,WAAW,KAAK,yBAAyB,CAAC,KAAK,sBAAsB,IAAI,CAAA;AAAA,IAAC;AAAA,EAE3E,CAAA,EACA,SAAA,EACA,MAAM,MAAM;AAAA,GAAS;AAEvB,EAAIF,OACHG,IAAAJ,EAAA,MAAKf,CAAmB,MAAxB,QAAAmB,EAAwB,yBAAyBH,EAAM,UAAU,CAAC;AAEpE;AAEAZ,IAAmB,WAAG;AACd,SAAAU;AAAA;AAAA;AAAA;AAAA,kBAIS,KAAK,SAAS,KAAK,4BAA4B,CAAC;AAAA;AAAA;AAAA;AAAA,aAIrD,KAAK,SAAS,KAAK,4BAA4B,CAAC;AAAA;AAAA;AAAA;AAAA,OAItDM,EAAoB,IAAI,CAAC;AAAA,cAClBP,QAAKZ,GAA2BE,CAAA,CAAA;AAAA;AAAA;AAG7C;AAECE,IAA8B,WAAG;AACjC,SAAI,CAAC,KAAK,0BAA0B,CAAC,KAAK,6BAAmCgB,IACtEP;AAAA;AAAA;AAAA;AAAA,kBAIS,KAAK,SAAS,KAAK,4BAA4B,CAAC;AAAA;AAAA;AAAA,YAGtD,KAAK,yBAAyB,EAAE;AAAA,aAC/B,KAAK,sBAAsB;AAAA,oCACJ,KAAK,0BAA0B;AAAA;AAAA,aAEtDD,QAAKZ,GAA2BE,CAAA,CAAA;AAAA,OACtC,KAAK,wBACJW,mBAAsB,KAAK,qBAAqB,6BAChDO,CAAO;AAAA;AAAA;AAAA,eAGA,KAAK,SAAS,KAAK,gBAAgB,CAAC;AAAA,gBACnCR,QAAKZ,GAA2BE,CAAA,CAAA;AAAA;AAAA;AAAA;AAAA;AAK/C;AA/GYI,EA0HK,SAAS,CAACe,CAAa;AAxHhCC,EAAA;AAAA,EADNC,EAAS;AAAA,GADCjB,EAEJ,WAAA,SAAA,CAAA;AAGPgB,EAAA;AAAA,EADCE,EAAM;AAAA,GAJIlB,EAKX,WAAA,aAAA,CAAA;AAGOgB,EAAA;AAAA,EADPE,EAAM;AAAA,GAPKlB,EAQJ,WAAA,yBAAA,CAAA;AAGAgB,EAAA;AAAA,EADPE,EAAM;AAAA,GAVKlB,EAWJ,WAAA,yBAAA,CAAA;AAGAgB,EAAA;AAAA,EADPE,EAAM;AAAA,GAbKlB,EAcJ,WAAA,0BAAA,CAAA;AAGAgB,EAAA;AAAA,EADPE,EAAM;AAAA,GAhBKlB,EAiBJ,WAAA,8BAAA,CAAA;AAjBIA,IAANgB,EAAA;AAAA,EADNG,EAAcpB,CAAW;AAAA,GACbC,CAAA;AA6Hb,MAAAoB,IAAepB;"}